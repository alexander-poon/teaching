---
output:
  word_document:
    reference_docx: document_template.docx
---

## `r d` District Performance

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```
<br>

**Introduction**

`r d` is a school district serving `r district_data[district_data$District == d, ]$Enrollment` students. Its expenditures in 2015 were `r paste0("$", sprintf("%.2f", district_data[district_data$District == d, ]$Per_Pupil_Expenditures))` per student.

<br>

**Demographic Information**

Here is a table with student demographic information for `r d`:

```{r demographics}

district_data %>%
    select(District, Pct_BHN, Pct_ED, Pct_SWD, Pct_EL) %>%
    rename(`Black/Hispanic/Native American` = Pct_BHN, `Economically Disadvantaged` = Pct_ED, `Students with Disabilities` = Pct_SWD, `English Learners` = Pct_EL) %>%
    gather(Subgroup, `Percentage of Students`, 2:5) %>%
    spread(District, `Percentage of Students`) %>%
    mutate_each(funs(paste0(., "%")), -Subgroup) %>%
    knitr::kable()

```

<br>

**3-8 Achievement Data**

Here is a graph with some achievement data for 3-8 subjects:

``` {r achievement, fig.width = 4, fig.height = 3}

district_data %>%
    select(District, Math, ELA, Science) %>%
    gather(Subject, `Percent P/A`, 2:4) %>%
    ggplot(aes(x = Subject, y = `Percent P/A`)) +
        geom_bar(color = "black", aes(fill = District), stat = "identity", width = 0.7, position = "dodge") +
        coord_cartesian(ylim = c(0, 100)) +
        ggthemes::theme_tufte() + 
        theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8),
            legend.title = element_text(size = 8), legend.text = element_text(size = 6))

```

**High School Achievement Data**

Here is a graph with some achievement data for EOC subjects:

``` {r eoc, fig.width = 5, fig.height = 3}

district_data %>%
    select(District, AlgI, AlgII, BioI, Chemistry, EngI, EngII, EngIII) %>%
    rename(`Algebra I` = AlgI, `Algebra II` = AlgII, `Biology I` = BioI, `English I` = EngI, `English II` = EngII, `English III` = EngIII) %>%
    gather(Subject, `Percent P/A`, 2:8) %>%
    ggplot(aes(x = Subject, y = `Percent P/A`)) +
        geom_bar(color = "black", aes(fill = District), stat = "identity", width = 0.7, position = "dodge") +
        coord_cartesian(ylim = c(0, 100)) +
        ggthemes::theme_tufte() + 
        theme(axis.title = element_text(size = 10), axis.text = element_text(size = 6),
            legend.title = element_text(size = 8), legend.text = element_text(size = 6))

```
