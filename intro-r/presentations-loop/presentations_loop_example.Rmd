---
title: "`r d` District Performance"
author: "Alexander Poon"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output: 
    ioslides_presentation:
        widescreen: TRUE
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

## Introduction

`r d` is a school district serving `r district_data[district_data$District == d, ]$Enrollment` students. Its expenditures in 2015 were `r paste0("$", sprintf("%.2f", district_data[district_data$District == d, ]$Per_Pupil_Expenditures))` per student.

``` {r map}

leaflet() %>%
    addTiles() %>%
    setView(geocode[geocode$District == d, ]$Longitude, geocode[geocode$District == d, ]$Latitude, zoom = 9) %>%
    addMarkers(geocode[geocode$District == d, ]$Longitude, geocode[geocode$District == d, ]$Latitude, popup = d)

```

## Demographic Information

Here is a table with student demographic information for `r d`:

```{r demographics}

district_data %>%
    select(District, Pct_BHN, Pct_ED, Pct_SWD, Pct_EL) %>%
    rename("Black/Hispanic/Native American" = Pct_BHN, "Economically Disadvantaged" = Pct_ED, "Students with Disabilities" = Pct_SWD, "English Learners" = Pct_EL) %>%
    gather("Subgroup", "Percentage of Students", 2:5) %>%
    spread("District", "Percentage of Students") %>%
    mutate_each(funs(paste0(., "%")), -Subgroup) %>%
    knitr::kable()

```

## 3-8 Achievement Data

Here is a graph with some achievement data for 3-8 subjects:

``` {r achievement, results = "asis"}

op <- options(gvis.plot.tag = "chart")

ach_plot <- district_data %>%
    select(District, Math, ELA, Science) %>%
    gather("Subject", "Percent P/A", 2:4) %>%
    spread("District", "Percent P/A") %>%
    gvisColumnChart(xvar = "Subject", yvar = c(d, "State"), options = list(title = "Achievement in 3-8 Subjects", width = 1000, height = 550, vAxis = "{baseline: 0, title: 'Percent Proficient or Advanced', maxValue: 100}"))

plot(ach_plot)

```

## High School Achievement Data

Here is a graph with some achievement data for EOC subjects:

``` {r googleVis, results = "asis"}

eoc_plot <- district_data %>%
    select(District, AlgI, AlgII, BioI, Chemistry, EngI, EngII, EngIII) %>%
    rename("Algebra I" = AlgI, "Algebra II" = AlgII, "Biology I" = BioI, "English I" = EngI, "English II" = EngII, "English III" = EngIII) %>%
    gather("Subject", "Percent P/A", 2:8) %>%
    spread("District", "Percent P/A") %>%
    gvisColumnChart(xvar = "Subject", yvar = c(d, "State"), options = list(title = "Achievement in EOC Subjects", width = 1000, height = 550, vAxis = "{baseline: 0, title: 'Percent Proficient or Advanced', maxValue: 100}"))

plot(eoc_plot)

```
