---
output:
  word_document:
    reference_docx: document_template.docx
---

## Davidson County District Performance

```{r setup, include = FALSE}

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

library(readr)
library(tidyr)
library(dplyr)
library(ggplot2)

ach_profile <- read_csv("achievement_profile_data.csv") %>%
    rename("District" = system_name) %>%
    filter(District == "State of Tennessee" | District == "Davidson County") %>%
    mutate(District = ifelse(District == "State of Tennessee", "State", District))

```
<br>

**Introduction**

Davidson County is a school district serving `r ach_profile[ach_profile$District == "Davidson County", ]$Enrollment` students. Its expenditures in 2015 were `r paste0("$", sprintf("%.2f", ach_profile[ach_profile$District == "Davidson County", ]$Per_Pupil_Expenditures))` per student.

<br>

**Demographic Information**

Here is a table with student demographic information for Davidson County:

```{r demographics}

ach_profile %>%
    filter(District == "Davidson County") %>%
    rename("Black/Hispanic/Native American" = Pct_BHN, "Economically Disadvantaged" = Pct_ED, "Students with Disabilities" = Pct_SWD, "English Learners" = Pct_EL) %>%
    select(one_of(c("Black/Hispanic/Native American", "Economically Disadvantaged", "Students with Disabilities", "English Learners"))) %>%
    gather("Subgroup", "Percentage of Students", 1:4) %>%
    knitr::kable()

```

<br>

**3-8 Achievement Data**

Here is a graph with some achievement data for 3-8 subjects:

``` {r achievement, fig.width = 4, fig.height = 3}

ach_profile %>%
    select(one_of(c("District", "Math", "ELA", "Science"))) %>%
    gather("Subject", "Percent P/A", 2:4) %>%
    ggplot(aes(x = Subject, y = `Percent P/A`)) +
        geom_bar(color = "black", aes(fill = District), stat = "identity", width = 0.7, position = "dodge") +
        coord_cartesian(ylim = c(0, 100)) +
        ggthemes::theme_tufte() + 
        theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8),
            legend.title = element_text(size = 8), legend.text = element_text(size = 6))

```

**High School Achievement Data**

Here is a graph with some achievement data for EOC subjects:

``` {r eoc, fig.width = 5, fig.height = 3}

ach_profile %>%
    select(one_of(c("District", "AlgI", "AlgII", "BioI", "Chemistry", "EngI", "EngII", "EngIII"))) %>%
    rename("Algebra I" = AlgI, "Algebra II" = AlgII, "Biology I" = BioI, "English I" = EngI, "English II" = EngII, "English III" = EngIII) %>%
    gather("Subject", "Percent P/A", 2:8) %>%
    ggplot(aes(x = Subject, y = `Percent P/A`)) +
        geom_bar(color = "black", aes(fill = District), stat = "identity", width = 0.7, position = "dodge") +
        coord_cartesian(ylim = c(0, 100)) +
        ggthemes::theme_tufte() + 
        theme(axis.title = element_text(size = 10), axis.text = element_text(size = 6),
            legend.title = element_text(size = 8), legend.text = element_text(size = 6))

```
